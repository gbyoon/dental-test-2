<!DOCTYPE html>
<html lang="ko" ng-app="myApp">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title><%= title %></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
      <!-- SCROLLS -->
      <!-- load bootstrap and fontawesome via CDN -->
      <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" />
      <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.0/css/font-awesome.css" />

      <!-- SPELLS -->
      <!-- load angular and angular route via CDN -->
      <!--
      <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.16/angular.min.js"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.16/angular-route.js"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.16/angular-animate.js"></script>
      <script src="http://angular-ui.github.io/bootstrap/ui-bootstrap-tpls-0.11.0.js"></script>
      -->

    
      <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.min.js"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular-route.js"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular-animate.js"></script>

      <script src="http://code.angularjs.org/1.2.16/angular-resource.js"></script>
      <script src="//angular-ui.github.io/bootstrap/ui-bootstrap-tpls-1.2.5.js"></script>

<!-- 
    <link rel="stylesheet" href="../../bower_components/angular-veasy-table/bower_components/bootstrap/dist/css/bootstrap.css">
    <link rel="stylesheet" href="../../bower_components/angular-veasy-table/bower_components/font-awesome/css/font-awesome.css">
    <link rel="stylesheet" href="../../bower_components/angular-veasy-table/bower_components/ng-sortable/dist/ng-sortable.css">
    <link rel="stylesheet" href="../../bower_components/angular-veasy-table/dist/css/veasy-table.min.css">
-->
    <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.css">
    <link rel="stylesheet" href="bower_components/font-awesome/css/font-awesome.css">
    <link rel="stylesheet" href="bower_components/ng-sortable/dist/ng-sortable.css">
    <link rel="stylesheet" href="bower_components/angular-veasy-table/dist/css/veasy-table.min.css">


    <!-- Libs -->
<!-- 
    <script type="text/javascript" src="../../bower_components/angular-veasy-table/bower_components/jquery/dist/jquery.js"></script>
    <script type="text/javascript" src="../../bower_components/angular-veasy-table/bower_components/angular/angular.js"></script>
    
    <script type="text/javascript" src="../../bower_components/angular-veasy-table/bower_components/angular-bootstrap/ui-bootstrap.js"></script>
    <script type="text/javascript" src="../../bower_components/angular-veasy-table/bower_components/angular-bootstrap/ui-bootstrap-tpls.js"></script>
    
    <script type="text/javascript" src="../../bower_components/angular-veasy-table/bower_components/ng-sortable/dist/ng-sortable.js"></script>
-->
    <script type="text/javascript" src="bower_components/jquery/dist/jquery.js"></script>
    <script type="text/javascript" src="bower_components/angular/angular.js"></script>
    
    <script type="text/javascript" src="bower_components/angular-bootstrap/ui-bootstrap.js"></script>
    <script type="text/javascript" src="bower_components/angular-bootstrap/ui-bootstrap-tpls.js"></script>
    
    <script type="text/javascript" src="bower_components/ng-sortable/dist/ng-sortable.js"></script>

    <!-- App -->
<!-- 
    <script type="text/javascript" src="../../bower_components/angular-veasy-table/dist/js/veasy-table.js"></script>
    <script type="text/javascript" src="../../bower_components/angular-veasy-table/dist/js/veasy-table-tpls.js"></script>
-->
    <script type="text/javascript" src="bower_components/angular-veasy-table/dist/js/veasy-table.js"></script>
    <script type="text/javascript" src="bower_components/angular-veasy-table/dist/js/veasy-table-tpls.js"></script>


<style>
  .typeahead-demo .custom-popup-wrapper {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    background-color: #f9f9f9;
  }

  .typeahead-demo .custom-popup-wrapper > .message {
    padding: 10px 20px;
    border-bottom: 1px solid #ddd;
    color: #868686;
  }

  .typeahead-demo .custom-popup-wrapper > .dropdown-menu {
    position: static;
    float: none;
    display: block;
    min-width: 160px;
    background-color: transparent;
    border: none;
    border-radius: 0;
    box-shadow: none;
  }
</style>

  </head>
    <body ng-controller="mainController">

      <!-- HEADER AND NAVBAR -->
      <header>
        <nav class="navbar navbar-default">
          <div class="container">
            <div class="navbar-header">
              <a class="navbar-brand" href="/">본사 관리 프로그램</a>
            </div>

            <ul class="nav navbar-nav navbar-right">
              <li><a href="#"><i class="fa fa-home"></i> Home</a></li>
              <li><a href="#denReg"><i class="fa fa-home"></i>신규치과등록</a></li>
              <li><a href="#denSrch"><i class="fa fa-shield"></i>치과검색</a></li>
              <li><a href="#memReg/"><i class="fa fa-comment"></i>신규고객등록</a></li>
              <li><a href="#nasgnMemSrch"><i class="fa fa-home"></i>미배정고객</a></li>
              <li><a href="#asgnMemSrch"><i class="fa fa-shield"></i>배정고객</a></li>
              <li><a href="#cmpltMemSrch"><i class="fa fa-comment"></i>완료고객</a></li>
              <li><a href="#logOut"><i class="fa fa-comment"></i>로그아웃</a></li>
            </ul>
          </div>
        </nav>
      </header>

        <!-- MAIN CONTENT AND INJECTED VIEWS -->
    <!-- MAIN CONTENT AND INJECTED VIEWS -->
    <div id="main">
      <!--{{ message }}-->
      <div ng-view></div>

      <!-- angular templating -->
      <!-- this is where content will be injected -->
    </div>

    {{test_string}}

  <script>
// script.js

    // create the module and name it scotchApp
    // also include ngRoute for all our routing needs
    //var app = angular.module('myApp', ['ngRoute','ui.bootstrap', 'ngAnimate', 'ngResource','siTable']);
    var app = angular.module('myApp', ['ngRoute','ui.bootstrap', 'ngAnimate', 'ngResource', 'veasyTable']);

    // configure our routes
    app.config(function($routeProvider) {
        $routeProvider

          // route for the home page
          .when('/', {
              templateUrl : 'pages/admin/home.html',
              controller  : 'mainController'
          })

          // route for the home page
          .when('/denReg', {
              templateUrl : 'pages/admin/denReg.html',
              controller  : 'denRegController',
              data : 'Dental Registariotn'
          })

          // route for the about page
          .when('/denSrch', {
              templateUrl : 'pages/admin/denSrch.html',
              controller  : 'denSrchController',
              data : 'Dental Search'
          })

          // route for the contact page
          .when('/memReg', {
              templateUrl : 'pages/admin/memReg.html',
              controller  : 'memRegController',
              data : 'Member Registration'
          })
        

          // route for the home page
          .when('/nasgnMemSrch', {
              templateUrl : 'pages/admin/nasgnMemSrch.html',
              controller  : 'nasgnMemSrchController',
              data : 'Not assign member Search'
          })

          // route for the about page
          .when('/asgnMemSrch', {
              templateUrl : 'pages/admin/asgnMemSrch.html',
              controller  : 'asgnMemSrchController',
              data : 'Assign Member Search'
          })

          // route for the contact page
          .when('/cmpltMemSrch', {
              templateUrl : 'pages/admin/cmpltMemSrch.html',
              controller  : 'cmpltMemSrchController',
              data : 'Complete Member Search'
          })

           // route for the contact page
          .when('/logOut', {
              templateUrl : 'pages/admin/logOut.html',
              controller  : 'logOutController',
              data : 'Logout'
          });

         // $locationProvider.html5Mode(true);

    });

    app.factory('peopleService', function ($http, $q, $timeout) {

      return {
        nAsgn: function (callback) {
          var nasgn_deferred = $q.defer();

          $timeout(function () {
            //$http.get('pages/js/people.json').success(function (data) {
            $http.get('/srchMemberInfoNasgn').success(function (data) {
              nasgn_deferred.resolve(data);
            });
          }, 500);

          return nasgn_deferred.promise;
        },
        asgn: function (callback) {
          var asgn_deferred = $q.defer();

          $timeout(function () {
            //$http.get('pages/js/people.json').success(function (data) {
            $http.get('/srchMemberInfoAsgn').success(function (data) {
              asgn_deferred.resolve(data);
            });
          }, 500);

          return asgn_deferred.promise;
        }
      }
    });


    app.service('dataService', function($http) {
      //delete $http.defaults.headers.common['X-Requested-With'];
      this.regDentalInfo = function(dentid, dentpwd, dentname, doctname, address, mobile, tel, callbackFunc) {
        
        $http.get('/regDentalInfo', {
          params: {
            dentid: dentid,
            dentpwd: dentpwd,
            dentname: dentname,
            doctname: doctname,
            address: address,
            mobile: mobile,
            tel: tel
            }
          }).success(function(data){
          // With the data succesfully returned, call our callback
          //$scope.test_string = data;
          callbackFunc(data);
          //alert("error");
        }).error(function(){
          //alert("error");
        });
       
      };

      this.srchDentalInfo = function(dentname, mobile, callbackFunc) {
        
        $http.get('/srchDentalInfo',{
          params: {
            dentname: dentname,
            mobile: mobile,
            //dentname: '김정호',
            //mobile: '01012341234',
            }
        }).success(function(data){
          // With the data succesfully returned, call our callback
          //$scope.test_string = data;
          callbackFunc(data);
          //alert("error");
        }).error(function(){
          //alert("error");
        });
       
      };

      this.regMemberInfo = function(name, birth, address, mobile, stat, dntl_key, callbackFunc) {
        
        $http.get('/regMemberInfo', {
          params: {
            name: name,
            birth: birth,
            address: address,
            mobile: mobile,
            stat: stat,
            dntl_key: dntl_key
            }
          }).success(function(data){
          // With the data succesfully returned, call our callback
          //$scope.test_string = data;
          callbackFunc(data);
          //alert("error");
        }).error(function(){
          //alert("error");
        });
       
      };

      this.asgnDentalToMem = function(name, birth, mobile, stat, dntl_name, dntl_mobile, callbackFunc) {
        
        $http.get('/asgnDentalToMem', {
          params: {
            memName: name,
            memBirth: birth,
            memMobile: mobile,
            memStat: stat,
            dntl_name: dntl_name,
            dntl_mobile: dntl_mobile
            }
          }).success(function(data){
          // With the data succesfully returned, call our callback
          //$scope.test_string = data;
          callbackFunc(data);
          //alert("error");
        }).error(function(){
          //alert("error");
        });
       
      };

    });


    // create the controller and inject Angular's $scope
    app.controller('mainController', function($scope) {
      // create a message to display in our view
      $scope.message = '하이브리드 치아보험 홈페이지!';
    });

    // create the controller and inject Angular's $scope
    app.controller('denRegController', function($scope, $route, dataService) {
      // create a message to display in our view
      $scope.message = '신규 치과 등록 페이지!';
      $scope.msg = $route.current.data;

      $scope.saveDentalView = function(){
        var dentid = $scope.dentalid;
        var dentpwd = $scope.dentalpwd;
        var dentname = $scope.dentalname;
        var doctname = $scope.doctorname;
        var address = $scope.address;
        var mobile = $scope.mobile;
        var tel = $scope.tel;

        $scope.msg = dentid+' : '+dentpwd+' : '+dentname+' : '+doctname+' : '+address+' : '+mobile+' : '+tel;

        dataService.regDentalInfo(dentid, dentpwd, dentname, doctname, address, mobile, tel, function(dataResponse) {

          //$scope.test_string = dataResponse;
          if(dataResponse == 'Success')
          {
              alert('Success');
            //window.location.href = '/router' ;
          }
          else
          {
              alert('Fail');
            //window.location.href = '/adminLogin' ;
          }

        });

      };

    });

    // create the controller and inject Angular's $scope
    app.controller('denSrchController', function($scope, $http, $route, dataService) {
    //app.controller('denSrchController', function($scope, $http, $route) {
      // create a message to display in our view
      $scope.message = '치과 검색 페이지!';
      $scope.msg = $route.current.data;
  /*
      dataService.srchDentalInfo(function(dataResponse) {

        $scope.test_string = dataResponse;
        $scope.objects = dataResponse;

        $scope.totalItems = $scope.objects.length;
        $scope.currentPage = 1;
        $scope.numPerPage = 5;

        $scope.paginate = function(value) {
            var begin, end, index;
            begin = ($scope.currentPage - 1) * $scope.numPerPage;
            end = begin + $scope.numPerPage;
            index = $scope.objects.indexOf(value);
            return (begin <= index && index < end);
        };

      });
  */

      // Any function returning a promise object can be used to load values asynchronously
      $scope.getDentalCode = function(val) {
        return $http.get('/srchDentalByArg', {
          params: {
            name: val
          }
        }).then(function(response){
          return response.data.map(function(item){
            //$scope.testMemcode = response;
            var obj = {};
            obj.dentName = item.dentName;
            obj.mobile = item.mobile;
            return obj;
            //return item.name;
          });
        });
      };

      $scope.onSelect = function ($item, $model, $label) {
          console.log($item);
          if($item.dentName){
             $scope.activeName = $item.dentName        
             $scope.activeCode = $item.mobile        
          }

          dataService.srchDentalInfo($item.dentName, $item.mobile, function(dataResponse) {

            //$scope.test_string = dataResponse;
            $scope.objects = dataResponse;

            $scope.totalItems = $scope.objects.length;
            $scope.currentPage = 1;
            $scope.numPerPage = 5;

            $scope.paginate = function(value) {
                var begin, end, index;
                begin = ($scope.currentPage - 1) * $scope.numPerPage;
                end = begin + $scope.numPerPage;
                index = $scope.objects.indexOf(value);
                return (begin <= index && index < end);
            };

          });

      };

    /*
      $scope.objects = [
        {id: 1, name: "1st"},  {id: 2, name: "2nd"},  {id: 3, name: "3rd"},
        {id: 4, name: "4th"},  {id: 5, name: "5th"},  {id: 6, name: "6th"},
        {id: 7, name: "7th"},  {id: 8, name: "8th"},  {id: 9, name: "9th"},
        {id: 10, name: "10th"},{id: 11, name: "11th"},{id: 12, name: "12th"}
      ]

      $scope.totalItems = $scope.objects.length;
      $scope.currentPage = 1;
      $scope.numPerPage = 5;
      
      $scope.paginate = function(value) {
        var begin, end, index;
        begin = ($scope.currentPage - 1) * $scope.numPerPage;
        end = begin + $scope.numPerPage;
        index = $scope.objects.indexOf(value);
        return (begin <= index && index < end);
      };
    */
    /*
      $scope.rowCollection = [
          {firstName: 'Laurent', lastName: 'Renard', birthDate: new Date('1987-05-21'), balance: 102, email: 'whatever@gmail.com'},
          {firstName: 'Blandine', lastName: 'Faivre', birthDate: new Date('1987-04-25'), balance: -2323.22, email: 'oufblandou@gmail.com'},
          {firstName: 'Francoise', lastName: 'Frere', birthDate: new Date('1955-08-27'), balance: 42343, email: 'raymondef@gmail.com'}
      ];
    */

    }); //denSrchController

    // create the controller and inject Angular's $scope
    app.controller('memRegController', function($scope, $route, dataService) {
      // create a message to display in our view
      $scope.message = '신규 회원 등록 페이지!';
      $scope.msg = $route.current.data;

      $scope.saveMemberView = function(){
        var name = $scope.name;
        var birth = $scope.birth;
        var address = $scope.address;
        var mobile = $scope.mobile;
        var stat = 0;
        var dntl_key = 0;
        $scope.msg = name+' : '+birth+' : '+address+' : '+mobile+' : '+stat+' : '+dntl_key;

        dataService.regMemberInfo(name, birth, address, mobile, stat, dntl_key, function(dataResponse) {

          //$scope.test_string = dataResponse;
          if(dataResponse == 'Success')
          {
              alert('Success');
            //window.location.href = '/router' ;
          }
          else
          {
              alert('Fail');
            //window.location.href = '/adminLogin' ;
          }

        });

      };

    });

    // create the controller and inject Angular's $scope
    app.controller('nasgnMemSrchController', function($scope, $http, $route, $timeout, peopleService, dataService) {
      // create a message to display in our view
      $scope.message = '미배정 고객 리스트!';
      $scope.msg = $route.current.data;
/*
      $scope.filter = {
        $: ''
      };

      $scope.params = {};

      var url = 'pages/js/issues.offline.json';
      $http.get(url).then(function(issues) {
        $scope.issues = issues.data;
      });
*/


    /***********************************************************/
      var memName, memBirth, memMobile, memStat, dntl_name, dntl_mobile;

      $scope.showUser = false;
      $scope.people = [];
      $scope.selecteds = [];

      var init = function () {
        $scope.config = {
          id: 'veasy-table',
          columns: [
            { header: 'Index',         value: 'memIdx',          size: 5, show: true },
            { header: 'Name', value: 'name',  size: 10, show: true },
            { header: 'Birth',  value: 'birth',   size: 10, show: true },
            { header: 'Address',      value: 'address',       size: 20, show: true },
            { header: 'Mobile',    value: 'mobile',     size: 10, show: true }
          ],
          /*
          columns: [
            { header: 'Id',         value: 'id',          size: 5, show: true },
            { header: 'First Name', value: 'first_name',  size: 40, show: true },
            { header: 'Last Name',  value: 'last_name',   size: 40, show: true },
            { header: 'Email',      value: 'email',       size: 0, show: false },
            { header: 'Country',    value: 'country',     size: 0, show: false },
            { header: 'IP',         value: 'ip_address',  size: 15, show: true }
          ],
          */
          /*
          checkbox: {
            enable: true,
            size: 20
          },
          */
          pagination: {
            enable: true,
            currentPage: 0,
            itemsPerPage: 10,
          },
          filter: {
            enable: true,
            conditional: false,
            delay: 500
          },
          /*
          columnFilter: {
            enable: true,
            autoOpen: true,
            modalSize: 'md'
          },
          sort: {
            enable: true
          },
          */
          resizable: {
            enable: true,
            minimumSize: 5
          },
          events: {
            onClickRow: function (row) {
              //alert('Row Clicked: ' + JSON.stringify(row.memIdx) + 'Row Clicked: ' + JSON.stringify(row.name) + '. More details in your console.');
              console.log(JSON.stringify(row, null, 2));
              console.log('---------------------------------');
              console.log('');

              $scope.tUser = row.name;

              memName = row.name ;
              memBirth = row.birth ;
              memMobile = row.mobile ;
              memStat = 0;//row.stat ;

              $scope.showUser = true;
            },
            onApplyColumnFilter: function (columns) {
              alert('Applied Columns! More details in your console.');
              console.log(JSON.stringify(columns, null, 2));
              console.log('---------------------------------');
              console.log('');
            },
            onTableStateChange: function (columns) {
              alert('State changed! More details in your console.');
              console.log(JSON.stringify(columns, null, 2));
              console.log('---------------------------------');
              console.log('');
            }
          }
        };

        peopleService.nAsgn().then(function (data) {
          var count = data.length;
          var memData = [];
          var id , name , birth , add , mob , dntl ;

          if(count == 0)
          {
            memData.push({"memIdx":'0',"name":'none',"birth":'none',"address":'none',"mobile":'none',"dental":'none'});
            $scope.people = memData;
          }
          else
          {
            $scope.people = data;
          }
        });

      };
      init();
    /*
      $scope.addPerson = function (person) {
        person.id = ($scope.people.length + 1);
        $scope.people.push(person);
        $scope.person = {};
      };
    */

    /***********************************************************/

    $scope.getDentalCode = function(val) {
      return $http.get('/srchDentalByArg', {
        params: {
          name: val
        }
      }).then(function(response){
        return response.data.map(function(item){
          //$scope.testMemcode = response;

          dntl_name = item.dentName;
          dntl_mobile = item.mobile;

          var obj = {};
          obj.dentName = item.dentName;
          obj.mobile = item.mobile;
          return obj;
          //return item.name;
        });
      });
    };

    $scope.saveUser = function() {
      //alert('Assign dental clinic to users'+$scope.obj.dentName+' '+$scope.obj.mobile+' '+$scope.tUser);

        dataService.asgnDentalToMem(memName, memBirth, memMobile, memStat, dntl_name, dntl_mobile, function(dataResponse){
          //$scope.test_string = dataResponse;
          if(dataResponse == 'Success')
          {
              alert('Success');
            //window.location.href = '/router' ;
          }
          else
          {
              alert('Fail');
            //window.location.href = '/adminLogin' ;
          }

        });
    };

    $scope.clsShowUser = function() {
      $scope.showUser = false;
    };

    $scope.hideDentalInfo = function() {
      $scope.obj.dentName = null;
      $scope.obj.mobile = null;
      $scope.test_string = 'call hideDentalInfo';
    };  

    $scope.refreshUserList = function() {
      peopleService.nAsgn().then(function (data) {
        $scope.people = data;
        $scope.test_string = 'call refreshUserList';
      });
    };


    }); //nasgnMemSrchController

    // create the controller and inject Angular's $scope
    app.controller('asgnMemSrchController', function($scope, $http, $route, $timeout, peopleService, dataService) {
        // create a message to display in our view
        $scope.message = '배정 고객 리스트!';
        $scope.msg = $route.current.data;


      /***********************************************************/
        var memName, memBirth, memMobile, memStat, dntl_name, dntl_mobile;

        $scope.showUser = false;
        $scope.people = [];
        $scope.selecteds = [];

        var init = function () {
          $scope.config = {
            id: 'veasy-table',
            columns: [
              { header: 'Index',         value: 'memIdx',          size: 5, show: true },
              { header: 'Name', value: 'name',  size: 10, show: true },
              { header: 'Birth',  value: 'birth',   size: 10, show: true },
              { header: 'Address',      value: 'address',       size: 20, show: true },
              { header: 'Mobile',    value: 'mobile',     size: 10, show: true },
              { header: 'Dental',    value: 'dental',     size: 10, show: true }
            ],
            /*
            columns: [
              { header: 'Id',         value: 'id',          size: 5, show: true },
              { header: 'First Name', value: 'first_name',  size: 40, show: true },
              { header: 'Last Name',  value: 'last_name',   size: 40, show: true },
              { header: 'Email',      value: 'email',       size: 0, show: false },
              { header: 'Country',    value: 'country',     size: 0, show: false },
              { header: 'IP',         value: 'ip_address',  size: 15, show: true }
            ],
            */
            /*
            checkbox: {
              enable: true,
              size: 20
            },
            */
            pagination: {
              enable: true,
              currentPage: 0,
              itemsPerPage: 10,
            },
            filter: {
              enable: true,
              conditional: false,
              delay: 500
            },
            /*
            columnFilter: {
              enable: true,
              autoOpen: true,
              modalSize: 'md'
            },
            sort: {
              enable: true
            },
            */
            resizable: {
              enable: true,
              minimumSize: 5
            },
            events: {
              onClickRow: function (row) {
                //alert('Row Clicked: ' + JSON.stringify(row.id) + 'Row Clicked: ' + JSON.stringify(row.first_name) + '. More details in your console.');
                alert('Row Clicked: ' + JSON.stringify(row.memIdx) + 'Row Clicked: ' + JSON.stringify(row.name) + '. More details in your console.');
                console.log(JSON.stringify(row, null, 2));
                console.log('---------------------------------');
                console.log('');

                $scope.tUser = row.name;

                memName = row.name ;
                memBirth = row.birth ;
                memMobile = row.mobile ;
                memStat = 1;//row.stat ;

                $scope.showUser = true;
              },
              onApplyColumnFilter: function (columns) {
                alert('Applied Columns! More details in your console.');
                console.log(JSON.stringify(columns, null, 2));
                console.log('---------------------------------');
                console.log('');
              },
              onTableStateChange: function (columns) {
                alert('State changed! More details in your console.');
                console.log(JSON.stringify(columns, null, 2));
                console.log('---------------------------------');
                console.log('');
              }
            }
          };

          peopleService.asgn().then(function (data) {
            var count = data.length;
            var memData = [];
            var id , name , birth , add , mob , dntl ;

            if(count == 0)
            {
              memData.push({"memIdx":'0',"name":'none',"birth":'none',"address":'none',"mobile":'none',"dental":'none'});
              $scope.people = memData;
            }
            else
            {
              for (i in data)
              {
                id = data[i].memIdx;
                name = data[i].name;
                birth = data[i].birth;
                add = data[i].address;
                mob = data[i].mobile;
                dntl = data[i].dntl_key.dentName;
                memData.push({"memIdx":id,"name":name,"birth":birth,"address":add,"mobile":mob,"dental":dntl});
              }
              $scope.people = memData;
              //$scope.test_string = memData;
            }
          });

        };
        init();
/*
        $scope.addPerson = function (person) {
          person.id = ($scope.people.length + 1);
          $scope.people.push(person);
          $scope.person = {};
        };
*/

      /***********************************************************/

        $scope.getDentalCode = function(val) {
          return $http.get('/srchDentalByArg', {
            params: {
              name: val
            }
          }).then(function(response){
            return response.data.map(function(item){
              //$scope.testMemcode = response;

              dntl_name = item.dentName;
              dntl_mobile = item.mobile;

              var obj = {};
              obj.dentName = item.dentName;
              obj.mobile = item.mobile;
              return obj;
              //return item.name;
            });
          });
        };

        $scope.saveUser = function() {
          //alert('Assign dental clinic to users'+$scope.obj.dentName+' '+$scope.obj.mobile+' '+$scope.tUser);

            dataService.asgnDentalToMem(memName, memBirth, memMobile, memStat, dntl_name, dntl_mobile, function(dataResponse) {

              $scope.test_string = dataResponse;
              if(dataResponse == 'Success')
              {
                  alert('Success');
                //window.location.href = '/router' ;
              }
              else
              {
                  alert('Fail');
                //window.location.href = '/adminLogin' ;
              }

            });
        };

        $scope.clsShowUser = function() {
          $scope.showUser = false;
        };

        $scope.hideDentalInfo = function() {
          $scope.obj.dentName = null;
          $scope.obj.mobile = null;
          $scope.test_string = 'call hideDentalInfo';
        };  

        $scope.refreshUserList = function() {
          peopleService.asgn().then(function (data) {
            var count = data.length;
            var memData = [];
            var id , name , birth , add , mob , dntl ;

            if(count == 0)
            {
              memData.push({"memIdx":'0',"name":'none',"birth":'none',"address":'none',"mobile":'none',"dental":'none'});
              $scope.people = memData;
            }
            else
            {
              for (i in data)
              {
                id = data[i].memIdx;
                name = data[i].name;
                birth = data[i].birth;
                add = data[i].address;
                mob = data[i].mobile;
                dntl = data[i].dntl_key.dentName;
                memData.push({"memIdx":id,"name":name,"birth":birth,"address":add,"mobile":mob,"dental":dntl});
              }
              $scope.people = memData;
              //$scope.test_string = memData;
            }
          });
        };

    });//asgnMemSrchController

    // create the controller and inject Angular's $scope
    app.controller('cmpltMemSrchController', function($scope, $http, $route, $timeout, peopleService, dataService) {
        // create a message to display in our view
        $scope.message = '완료 고객 리스트!';
        $scope.msg = $route.current.data;

      /***********************************************************/
        var memName, memBirth, memMobile, memStat, dntl_name, dntl_mobile;

        $scope.showUser = false;
        $scope.people = [];
        $scope.selecteds = [];

        var init = function () {
          $scope.config = {
            id: 'veasy-table',
            columns: [
              { header: 'Index',         value: 'memIdx',          size: 5, show: true },
              { header: 'Name', value: 'name',  size: 10, show: true },
              { header: 'Birth',  value: 'birth',   size: 10, show: true },
              { header: 'Address',      value: 'address',       size: 20, show: true },
              { header: 'Mobile',    value: 'mobile',     size: 10, show: true },
              { header: 'Dental',    value: 'dental',     size: 10, show: true }
            ],
            /*
            checkbox: {
              enable: true,
              size: 20
            },
            */
            pagination: {
              enable: true,
              currentPage: 0,
              itemsPerPage: 10,
            },
            filter: {
              enable: true,
              conditional: false,
              delay: 500
            },
            /*
            columnFilter: {
              enable: true,
              autoOpen: true,
              modalSize: 'md'
            },
            sort: {
              enable: true
            },
            */
            resizable: {
              enable: true,
              minimumSize: 5
            },
            events: {
              onClickRow: function (row) {
                //alert('Row Clicked: ' + JSON.stringify(row.id) + 'Row Clicked: ' + JSON.stringify(row.first_name) + '. More details in your console.');
                alert('Row Clicked: ' + JSON.stringify(row.memIdx) + 'Row Clicked: ' + JSON.stringify(row.name) + '. More details in your console.');
                console.log(JSON.stringify(row, null, 2));
                console.log('---------------------------------');
                console.log('');

                $scope.tUser = row.name;

                memName = row.name ;
                memBirth = row.birth ;
                memMobile = row.mobile ;
                memStat = 1;//row.stat ;

                $scope.memName = row.name ;
                $scope.memBirth = row.birth ;
                $scope.memAddress = row.address ;
                $scope.memMobile = row.mobile ;
                $scope.dental = row.dental ;

                $scope.showUser = true;
              },
              onApplyColumnFilter: function (columns) {
                alert('Applied Columns! More details in your console.');
                console.log(JSON.stringify(columns, null, 2));
                console.log('---------------------------------');
                console.log('');
              },
              onTableStateChange: function (columns) {
                alert('State changed! More details in your console.');
                console.log(JSON.stringify(columns, null, 2));
                console.log('---------------------------------');
                console.log('');
              }
            }
          };

          peopleService.asgn().then(function (data) {
            var count = data.length;
            var memData = [];
            var id , name , birth , add , mob , dntl ;

            if(count == 0)
            {
              memData.push({"memIdx":'0',"name":'none',"birth":'none',"address":'none',"mobile":'none',"dental":'none'});
              $scope.people = memData;
            }
            else
            {
              for (i in data)
              {
                id = data[i].memIdx;
                name = data[i].name;
                birth = data[i].birth;
                add = data[i].address;
                mob = data[i].mobile;
                dntl = data[i].dntl_key.dentName;
                memData.push({"memIdx":id,"name":name,"birth":birth,"address":add,"mobile":mob,"dental":dntl});
              }
              $scope.people = memData;
              //$scope.test_string = memData;
            }
          });

        };

        init();
      /*
        $scope.addPerson = function (person) {
          person.id = ($scope.people.length + 1);
          $scope.people.push(person);
          $scope.person = {};
        };
      */

      /***********************************************************/

        $scope.clsShowUser = function() {
          $scope.showUser = false;
        };

    });//cmpltMemSrchController

    // create the controller and inject Angular's $scope
    app.controller('logOutController', function($scope, $route) {
        // create a message to display in our view
        $scope.message = 'Everyone come and see how good I look!';
        $scope.msg = $route.current.data;
        
        window.location.href = '/adminLogout' ;
    });

  </script>


</body>
</html>


